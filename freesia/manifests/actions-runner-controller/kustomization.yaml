apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: actions-runner-controller

resources:
  - namespace.yaml

helmCharts:
  - name: gha-runner-scale-set-controller
    repo: oci://ghcr.io/actions/actions-runner-controller-charts
    version: 0.12.1
    releaseName: arc-controller
    namespace: actions-runner-controller
    valuesInline:
      flags:
        # ログレベルを設定
        logLevel: "info"
        # メトリクスを有効化
        enableLeaderElection: true
      
      # リソース制限
      resources:
        limits:
          cpu: 500m
          memory: 512Mi
        requests:
          cpu: 100m
          memory: 128Mi
      
      # セキュリティコンテキスト
      securityContext:
        runAsNonRoot: true
        runAsUser: 1000
        fsGroup: 1000
      
      # ポッドのセキュリティコンテキスト
      podSecurityContext:
        runAsNonRoot: true
        runAsUser: 1000
        fsGroup: 1000